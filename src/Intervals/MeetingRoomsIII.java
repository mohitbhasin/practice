import java.util.*;

class MeetingRoomsIII {
	public static void main(String args[]) {
		List<int[][]> meetingsList = new ArrayList<>();
		List<Integer> roomsCountList = new ArrayList<>();
		meetingsList.add(new int[][] {{0,10},{1,5},{2,7},{3,4}});
		roomsCountList.add(2);
		meetingsList.add(new int[][] {{1,20},{2,10},{3,5},{4,9},{6,8}});
		roomsCountList.add(3);
    meetingsList.add(new int[][] {{274,549},{501,1017},{566,1248},{12,676},{120,185},{401,1121},{651,1075},{212,231},{76,328},{185,1151},{42,363},{687,1655},{624,1443},{991,1144},{249,859},{18,884},{241,767},{763,1417},{572,767},{635,1105},{300,656},{741,776},{26,221},{259,1224},{567,921},{181,394},{737,1039},{769,1288},{734,1238},{459,759},{598,840},{11,43},{877,1334},{511,894},{264,440},{323,856},{671,878},{630,634},{108,569},{666,1067},{263,370},{791,912},{428,571},{429,1161},{726,1071},{798,882},{273,597},{168,841},{868,1138},{242,565},{935,1203},{740,933},{370,1174},{801,1280},{999,1413},{746,893},{87,787},{646,1260},{322,880},{0,956},{596,711},{593,1419},{361,489},{649,917},{337,1201},{85,129},{356,936},{139,873},{668,1298},{287,1129},{65,468},{520,1242},{454,619},{607,622},{899,952},{295,1082},{299,698},{482,1359},{580,742},{513,1092},{444,448},{209,1020},{839,1251},{694,1289},{488,820},{816,1430},{496,906},{31,593},{297,713},{973,1479},{244,979},{714,1689},{672,1505},{16,765},{57,826},{716,1095},{894,1035},{859,1393},{280,1274},{856,1739},{182,426},{813,1282},{966,1013},{383,995},{27,729},{306,691},{437,1039},{940,1357},{90,421},{395,1005},{802,1020},{449,497},{214,974},{642,1584},{698,716},{258,878},{768,1204},{477,1311},{240,1096},{996,1736},{576,760},{468,715},{659,858},{826,1035},{152,835},{599,1399},{470,1090},{749,1547},{246,1180},{143,1135},{266,1041},{307,881},{74,174},{193,1083},{744,1482},{255,309},{441,1380},{995,1052},{767,1611},{936,1883},{613,727},{665,1214},{781,1479},{917,1420},{617,1035},{296,866},{461,714},{312,1278},{796,1630},{24,564},{14,833},{912,1180},{186,975},{75,876},{144,831},{770,1487},{446,886},{342,358},{41,832},{818,1661},{279,1254},{862,864},{759,834},{568,1426},{290,990},{281,949},{413,1161},{923,1293},{100,644},{115,568},{961,1121},{480,883},{869,941},{944,1876},{782,1516},{270,305},{20,26},{618,647},{282,549},{340,888},{353,860},{835,1573},{205,925},{7,395},{234,1000},{717,852},{834,1186},{806,957},{378,1318},{893,1780},{360,619},{585,1400},{174,279},{217,880},{458,1082},{926,1555},{527,715},{172,508},{465,564},{852,1126},{452,845},{986,1948},{872,1236},{479,1259},{847,1467},{3,599},{262,1134},{956,1566},{154,347},{799,1726},{316,734},{406,747},{365,577},{903,1818},{946,1295},{522,1138},{302,808},{298,469},{443,915},{647,1487},{853,862},{387,898},{715,1040},{235,326},{765,1155},{417,1051},{742,1610},{162,498},{547,1025},{823,1779},{89,483},{98,918},{8,222},{326,1224},{712,1229},{920,1749},{319,611},{251,703},{348,446},{881,1597},{650,1403},{985,1330},{40,647},{45,821},{88,662},{591,634},{155,1115},{704,1278},{112,690},{686,1159},{167,198},{58,182},{725,915},{997,1441},{814,1125},{410,1081},{248,737},{938,1593},{504,1324},{988,1562},{989,1665},{394,940},{228,660},{317,1245},{113,219},{17,440},{600,1310},{416,958},{941,1245},{722,1227},{559,909},{523,599},{549,1152},{957,1733},{198,262},{339,822},{736,847},{681,770},{804,1739},{261,400},{30,726},{460,468},{876,1070},{237,775},{55,341},{363,531},{883,1299},{117,979},{350,803},{29,535},{676,1480},{230,683},{305,664},{545,1049},{375,1001},{953,1664},{775,1517},{134,876},{107,225},{405,419},{789,1426},{674,1559},{201,423},{551,1254},{776,884},{418,1056},{945,1599},{860,1639},{633,942},{469,1060},{754,1276},{189,671},{399,1352},{587,1104},{101,188},{902,1538},{229,453},{289,491},{391,529},{508,1056},{908,1272},{871,1654},{225,467},{669,1077},{622,947},{707,843},{673,1017},{414,599},{211,1127},{608,926},{398,854},{93,1044},{762,1420},{315,665},{771,1225},{206,834},{403,438},{359,1182},{314,355},{498,1412},{829,1191},{631,1511},{974,1896},{184,624},{777,1089},{887,1725},{493,1197},{535,1122},{64,455},{682,813},{176,257},{892,1732},{552,864},{220,426},{653,880},{9,573},{222,1048},{575,1011},{196,508},{179,800},{807,913},{141,805},{602,1175},{256,986},{825,1521},{149,765},{525,1204},{94,105},{811,1364},{606,1114},{404,1111},{626,1562},{484,943},{702,966},{159,914},{820,1092},{590,1344},{661,1239},{351,406},{515,794},{761,1559},{578,726},{854,1236},{921,1810},{713,1667},{560,1262},{311,1132},{758,773},{128,691},{951,1673},{987,1698},{699,1124},{271,303},{914,1776},{589,996},{564,1550},{959,1153},{347,549},{268,600},{718,1648},{588,612},{218,1118},{530,1138},{611,1277},{703,1576},{558,817},{50,826},{2,973},{467,1077},{565,1294},{450,1340},{819,1368},{52,800},{328,578},{226,302},{711,1635},{208,1013},{92,355},{886,1274},{518,712},{949,1502},{232,376},{91,972},{954,1880},{968,1036},{539,616},{643,1134},{870,1501},{491,1276},{636,776},{147,1033},{485,1374},{817,1168},{466,1102},{442,1426},{637,1380},{330,554},{705,1186},{757,1513},{960,1493},{150,639},{175,733},{544,986},{610,1133},{301,840},{260,1174},{487,876},{1,671},{358,548},{377,1217},{719,1449},{5,872},{880,1733},{594,595},{603,622},{922,1166},{146,1122},{158,1101},{553,589},{126,1112},{334,847},{371,1218},{910,1353},{13,206},{145,523},{833,1273},{272,689},{579,1001},{644,1004},{304,1259},{278,1134},{203,896},{35,966},{563,1194},{111,158},{924,1220},{571,1498},{978,1077},{329,710},{252,1065},{562,1555},{170,899},{47,240},{683,749},{732,886},{464,966},{654,919},{445,1241},{267,1004},{276,429},{848,1682},{338,1020},{942,1411},{577,602},{114,976},{324,724},{292,1130},{321,747},{253,445},{800,1214},{947,1759},{815,944},{751,851},{352,801},{990,1356},{584,744},{658,1561},{500,566},{284,1149},{285,587},{641,770},{841,1668},{557,840},{81,494},{529,1284},{68,289},{153,203},{994,1675},{932,1195},{788,1306},{231,972},{390,660},{656,1515},{784,1077},{830,1557},{106,1041},{693,855},{166,371},{866,1478},{879,1520},{216,1104},{433,1008},{373,1016},{621,848},{481,1014},{573,1427},{495,1074},{200,259},{684,1004},{171,900},{747,853},{748,1687},{885,1383},{615,632},{897,1334},{448,1332},{388,880},{48,206},{832,1435},{96,649},{967,1846},{950,1659},{34,832},{308,472},{425,1347},{851,1623},{662,996},{780,818},{455,1446},{952,1744},{764,1723},{497,983},{447,1263},{965,1624},{325,615},{341,483},{685,1381},{392,1011},{533,841},{709,1565},{663,684},{66,637},{197,208},{849,1034},{867,1063},{210,394},{192,1162},{125,443},{510,1314},{555,640},{543,1061},{70,183},{103,388},{943,1570},{257,981},{735,1564},{975,1328},{130,272},{729,1688},{805,981},{380,570},{349,1151},{180,720},{43,532},{236,597},{439,1097},{99,985},{382,1273},{331,1279},{215,1081},{977,1948},{419,686},{679,1029},{750,1271},{581,1360},{15,965},{116,752},{528,1384},{412,1329},{191,911},{335,1142},{357,1322},{161,896},{224,880},{837,848},{409,798},{102,632},{889,1730},{494,941},{385,843},{582,1374},{809,1666},{652,1392},{972,1584},{22,468},{223,287},{424,753},{44,963},{105,384},{992,1166},{634,1321},{124,181},{934,1175},{964,1002},{247,477},{19,769},{54,206},{164,835},{512,594},{688,1373},{828,1085},{207,886},{783,1489},{548,593},{121,831},{83,378},{597,666},{138,940},{792,1142},{664,684},{831,1519},{840,1155},{61,430},{332,1101},{824,1367},{822,1078},{574,851},{346,357},{519,1096},{753,1656},{708,908},{129,310},{536,1059},{534,1351},{245,615},{733,1171},{109,147},{345,713},{614,1317},{738,1265},{39,796},{1000,1403},{752,1721},{227,317},{689,1581},{516,530},{294,419},{195,1188},{123,888},{473,971},{254,286},{891,971},{286,1187},{354,489},{221,1218},{605,733},{546,1148},{766,1100},{233,676},{474,1325},{913,1116},{476,823},{657,1657},{838,1479},{958,1950},{194,626},{78,782},{51,1037},{963,1170},{379,731},{640,1593},{677,1466},{645,1515},{169,1089},{983,1651},{969,1378},{397,606},{33,78},{63,369},{625,1224},{336,927},{845,1538},{178,422},{71,746},{472,819},{836,1565},{884,1340},{962,1216},{486,562},{629,1367},{970,1582},{456,1228},{538,984},{156,657},{303,922},{204,1199},{132,862},{77,1002},{526,710},{427,813},{275,961},{803,1423},{609,708},{855,1137},{779,1644},{119,713},{402,1372},{46,658},{720,1002},{808,1321},{420,1084},{386,712},{827,1503},{678,1254},{895,1251},{475,1201},{131,789},{243,575},{148,610},{367,575},{890,1319},{550,1337},{706,1313},{904,1244},{864,1284},{283,1068},{888,1302},{909,1354},{542,796},{333,1193},{291,1001},{919,1124},{906,1139},{453,851},{896,1632},{183,721},{239,927},{49,553},{118,829},{843,1573},{873,1210},{463,1281},{10,864},{601,1528},{269,658},{857,1052},{509,1312},{23,939},{858,1304},{773,1553},{355,956},{632,1279},{53,332},{423,563},{507,559},{384,1267},{907,1828},{38,655},{916,1908},{344,704},{502,953},{928,1484},{900,955},{6,83},{570,910},{369,1137},{396,1127},{721,1678},{670,1050},{745,1195},{462,847},{727,1278},{73,678},{490,624},{700,823},{623,723},{915,1319},{219,258},{127,363},{372,1260},{517,763},{627,861},{506,664},{489,792},{499,855},{939,1160},{739,752},{4,319},{695,832},{376,1123},{28,706},{692,1392},{187,620},{364,482},{72,897},{793,1699},{250,1052},{875,1314},{288,354},{421,835},{760,1278},{59,599},{861,1692},{667,1035},{680,1482},{998,1734},{505,630},{690,1039},{104,1005},{163,1070},{648,772},{173,426},{929,1629},{135,680},{21,94},{701,1672},{177,457},{151,1025},{140,440},{62,944},{415,1122},{724,1423},{971,1172},{731,1367},{898,1817},{586,1104},{639,1333},{850,938},{532,1444},{190,1002},{655,670},{980,1083},{435,1385},{110,427},{393,968},{604,1281},{137,750},{483,629},{993,1160},{812,1333},{69,320},{774,900},{810,1746},{400,474},{874,1062},{434,1218},{136,745},{381,1315},{794,1500},{374,674},{451,613},{79,122},{82,633},{313,1020},{524,888},{84,164},{202,278},{60,668},{133,565},{979,1652},{797,1294},{772,1362},{36,543},{531,1118},{905,1368},{561,1288},{592,1498},{927,1548},{265,1132},{948,1425},{612,1532},{503,1421},{583,688},{514,1248},{32,724},{569,1073},{457,719},{976,1968},{309,1176},{556,852},{366,406},{213,553},{521,931},{937,1679},{790,1691},{188,833},{310,651},{743,1426},{97,116},{541,1351},{696,1610},{728,1057},{318,737},{165,644},{755,1688},{882,1078},{80,492},{37,1028},{697,1428},{786,1453},{723,1436},{411,1236},{925,1281},{982,1440},{865,1342},{537,1050},{660,1408},{157,885},{619,797},{842,1786},{981,1434},{554,1235},{86,224},{95,974},{320,1031},{901,1593},{471,1457},{984,1063},{426,507},{199,381},{628,1349},{440,1414},{863,1331},{431,480},{911,1279},{821,1564}}); // Output: 16
    roomsCountList.add(100);

		for(int i=0; i<meetingsList.size(); i++) {
			System.out.println(mostBooked(meetingsList.get(i), roomsCountList.get(i)));
		}
	}

  public static int mostBooked(int[][] meetings, int rooms) {
    int[] count = new int[rooms];

    PriorityQueue<Integer> availableRooms = new PriorityQueue<>();
    PriorityQueue<int[]> usedRooms = new PriorityQueue<>((a,b) -> a[1]!=b[1] ? a[1]-b[1] : a[2]-b[2]);
    //Filling available rooms
    for(int i=0; i<rooms; i++) {
      availableRooms.offer(i);
    }

    Arrays.sort(meetings, (a, b) -> a[0] - b[0]);

    for(int i=0; i<meetings.length; i++) {
      int startTime = meetings[i][0];
      int endTime = meetings[i][1];

      while(!usedRooms.isEmpty() && usedRooms.peek()[1]<=startTime) {
        availableRooms.offer(usedRooms.poll()[2]);
      }

      if(availableRooms.isEmpty()) {
        int end = usedRooms.peek()[1];
        int room = usedRooms.poll()[2];
        endTime = end + (endTime - startTime);
        availableRooms.offer(room);
      }

      int room = availableRooms.poll();
      usedRooms.offer(new int[]{startTime, endTime, room});
      count[room]++;
    }

    int maxCountRoom = 0;
    for(int i=1; i<rooms; i++) {
      if(count[i]>count[maxCountRoom]) {
        maxCountRoom=i;
      }
    }
    return maxCountRoom;
  }
}